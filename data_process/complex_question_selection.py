'''
筛选出complex question
''' 
import pandas as pd
import json

non_complex_ids = [5,9,53,75,76,77,90,92,103,138,148,161,174,191,206,349,351,374,375,376,377,378,379,380,381,392,393,394,400,404,405,407,408,409,410,412,413,414,415,419,421,425,427,428,429,430,431,432,433,438,439,447,449,452,456,458,459,460,464,465,467,468,469,479,485,486,487,491,494,497,500,503,508,510,514,515,520,525,528,531,532,536,540,541,544,546,548,549,554,555,558,560,563,571,574,577,583,585,586,589,590,594,598,599,600,602,603,604,605,607,608,610,611,612,616,617,618,620,621,626,632,634,635,636,638,639,640,641,642,646,649,652,653,655,656,657,658,660,661,662,663,666,668,672,678,679,680,681,682,683,685,686,688,690,691,692,694,695,696,697,698,700,701,702,703,704,705,706,707,708,709,711,713,714,715,717,719,721,722,723,725,726,728,730,733,734,737,739,740,743,744,745,747,749,752,756,758,760,761,763,764,765,766,767,769,770,771,774,779,781,785,786,787,788,789,791,793,794,795,796,797,798,800,803,804,809,818,822,830,840,856,870,878,885,906,930,937,942,945,971,973,981,982,984,986,992,993,997,998,1000,1001,1002,1003,1004,1005,1006,1007,1008,1011,1013,1015,1016,1019,1020,1023,1025,1027,1028,1029,1030,1031,1033,1034,1035,1037,1038,1039,1040,1041,1043,1044,1045,1046,1048,1050,1051,1053,1054,1056,1059,1060,1063,1065,1066,1067,1069,1070,1071,1072,1073,1076,1078,1079,1082,1083,1085,1086,1087,1088,1089,1094,1095,1096,1097,1098,1100,1101,1105,1106,1108,1109,1110,1112,1113,1114,1115,1116,1117,1119,1120,1122,1123,1124,1126,1128,1129,1130,1131,1133,1134,1135,1136,1137,1138,1139,1140,1141,1144,1146,1147,1149,1150,1151,1152,1153,1156,1157,1158,1160,1161,1162,1164,1165,1168,1169,1170,1171,1172,1174,1175,1176,1177,1179,1180,1182,1184,1185,1186,1188,1189,1192,1194,1195,1196,1198,1199,1207,1209,1211,1213,1220,1222,1223,1225,1227,1229,1234,1259,1265,1271,1273,1275,1290,1293,1295,1301,1312,1326,1331,1336,1343,1361,1374,1379,1381,1388,1445,1477,1486,1490,1496,1497,1510,1545,1555,1562,1573,1578,1589,1590,1592,1597,1600,1602,1603,1605,1606,1607,1608,1609,1610,1611,1616,1618,1619,1620,1623,1624,1625,1626,1631,1633,1634,1637,1638,1640,1641,1643,1644,1645,1646,1647,1648,1649,1650,1651,1653,1654,1655,1656,1657,1659,1660,1661,1662,1663,1664,1665,1666,1669,1670,1671,1672,1673,1674,1676,1677,1678,1679,1681,1682,1683,1684,1685,1686,1687,1688,1692,1693,1694,1695,1697,1698,1699,1701,1702,1703,1704,1705,1708,1709,1710,1714,1715,1716,1717,1718,1719,1720,1722,1723,1724,1726,1727,1728,1729,1731,1733,1734,1735,1737,1738,1740,1741,1742,1743,1744,1745,1746,1749,1752,1753,1754,1755,1757,1758,1759,1760,1761,1762,1763,1764,1766,1767,1769,1771,1773,1776,1777,1779,1780,1782,1783,1784,1785,1786,1787,1789,1790,1791,1793,1794,1796,1797,1798,1809,1815,1821,1829,1830,1832,1840,1849,1851,1858,1859,1860,1863,1870,1871,1872,1873,1882,1900,1908,1909,1912,1917,1921,1931,1932,1933,1934,1935,1943,1944,1955,1962,1987,1988,1989,1997,1998,1999,2000,2001,2002,2003,2004,2006,2017,2018,2019,2020,2024,2029,2035,2036,2043,2044,2047,2048,2050,2053,2054,2055,2056,2060,2062,2064,2066,2068,2070,2071,2072,2073,2074,2075,2076,2086,2087,2088,2089,2090,2091,2092,2093,2094,2095,2096,2097,2098,2099,2100,2101,2102,2103,2104,2105,2106,2107,2108,2109,2110,2111,2112,2113,2114,2115,2116,2117,2118,2119,2120,2121,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,2133,2134,2135,2136,2137,2138,2139,2140,2141,2142,2143,2144,2145,2146,2147,2148,2149,2150,2151,2152,2153,2154,2155,2156,2157,2158,2159,2160,2161,2162,2163,2164,2165,2166,2167,2168,2169,2170,2171,2172,2173,2174,2175,2177,2182,2186,2187,2189,2193,2199,2203,2204,2209,2210,2216,2217,2223,2224,2229,2235,2240,2241,2242,2244,2254,2265,2269,2275,2277,2280,2282,2287,2288,2292,2293,2299,2300,2304,2305,2306,2311,2320,2325,2328,2332,2346,2350,2358,2366,2369,2372,2400,2402,2404,2405,2406,2407,2409,2410,2411,2413,2416,2419,2420,2423,2425,2429,2430,2431,2432,2433,2434,2436,2437,2438,2440,2441,2442,2443,2445,2446,2447,2448,2449,2450,2451,2452,2453,2454,2455,2457,2458,2459,2460,2463,2465,2468,2470,2473,2474,2475,2476,2478,2479,2480,2481,2482,2485,2486,2487,2488,2496,2498,2499,2500,2501,2502,2503,2505,2511,2513,2514,2515,2516,2518,2519,2524,2528,2529,2533,2535,2536,2539,2540,2541,2542,2543,2545,2546,2548,2550,2551,2555,2556,2557,2559,2560,2561,2562,2563,2564,2566,2567,2568,2569,2570,2571,2572,2573,2575,2576,2577,2578,2580,2581,2582,2583,2584,2585,2588,2589,2590,2592,2593,2596,2597,2598,2600,2601,2602,2604,2605,2606,2607,2608,2609,2610,2611,2612,2613,2614,2615,2616,2617,2618,2619,2620,2621,2622,2623,2625,2626,2627,2628,2629,2630,2631,2632,2634,2636,2638,2639,2640,2642,2643,2644,2646,2647,2648,2649,2650,2651,2653,2654,2655,2656,2657,2658,2659,2661,2662,2663,2664,2665,2667,2669,2670,2672,2673,2674,2675,2676,2677,2678,2679,2680,2682,2683,2684,2685,2686,2688,2689,2691,2692,2693,2694,2695,2696,2696,2699,2701,2702,2703,2704,2705,2706,2707,2708,2709,2710,2711,2712,2713,2714,2715,2716,2717,2718,2719,2720,2721,2724,2725,2726,2727,2728,2729,2732,2733,2734,2735,2736,2737,2738,2740,2741,2743,2747,2749,2750,2751,2752,2753,2754,2755,2757,2758,2759,2760,2761,2762,2763,2764,2765,2766,2767,2768,2769,2770,2771,2772,2773,2774,2775,2777,2778,2779,2780,2782,2783,2784,2785,2787,2788,2789,2792,2793,2794,2796,2798,2802,2803,2819,2830,2848,2854,2858,2860,2864,2893,2895,2896,2909,2915,2916,2917,2928,2937,2939,2940,2941,2942,2943,2944,2945,2946,2947,2948,2951,2953,2964,2965,2969,2970,2972,2985,3000,3001,3002,3004,3008,3012,3014,3017,3018,3020,3025,3026,3017,3028,3031,3032,3034,3037,3040,3041,3044,3048,3058,3059,3062,3069,3073,3077,3079,3088,3091,3092,3093,3094,3097,3099,3100,3101,3105,3110,3111,3114,3116,3122,3124,3127,3128,3129,3132,3133,3138,3140,3141,3142,3143,3145,3149,3150,3151,3154,3155,3156,3157,3158,3159,3160,3161,3162,3163,3164,3168,3169,3170,3174,3175,3176,3177,3178,3179,3181,3184,3186,3187,3190,3193,3194,3195,3198,3200,3201,3202,3204,32053208,3209,3210,3213,3215,3217,3221,3222,3223,3224,3226,3229,3230,3232,3233,3235,3236,3237,3239,3240,3241,3243,3244,3246,3247,3249,3251,3253,3254,3258,3260,3261,3263,3264,3265,3267,3268,3270,3272,3273,3276,3277,3278,3279,3282,3284,3285,3286,3288,3289,3291,3294,3295,3296,3297,3298,3299,3300,3301,3302,3304,3305,3306,3307,3310,3314,3316,3317,3318,3319,3320,3321,3322,3323,3324,3326,3327,3329,3330,3331,3333,3334,3335,3337,3338,3339,3341,3344,3346,3349,3353,3354,3357,3358,3359,3362,3365,3366,3367,3368,3370,3371,3373,3374,3375,3378,3379,3380,3384,3386,3387,3388,3391,3392,3394,3395,3420,3507,3585,3595,3603,3605,3607,3609,3612,3613,3614,3615,3616,3618,3619,3620,3623,3624,3626,3627,3628,3630,3631,3632,3634,3635,3637,3638,3641,3642,3643,3646,3647,3649,3651,3652,3653,3657,3659,3660,3661,3662,3663,3665,3670,3672,3675,3678,3681,3682,3683,3684,3685,3686,3687,3690,3691,3692,3693,3696,3697,3698,3700,3702,3703,3706,3707,3708,3709,3710,3711,3713,3714,3715,3716,3717,3718,3719,3720,3721,3722,3723,3724,3725,3726,3727,3728,3729,3730,3731,3732,3733,3734,3735,3736,3737,3738,3739,3740,3741,3742,3743,3744,3745,3746,3747,3748,3749,3750,3751,3752,3753,3754,3755,3756,3757,3758,3759,3760,3761,3762,3763,3764,3765,3766,3767,3768,3769,3770,3771,3772,3773,3774,3775,3776,3777,3778,3779,3780,378,3782,3783,3784,3785,3786,3787,3788,3789,3790,3791,3792,3793,3794,3795,3796,3797,3798,3799]

# 读取output.csv文件
output_df = pd.read_csv('/mnt/xuyibo/Video-LLaMA/output.csv')

# 根据non_complex_ids排除不需要的ID
filtered_output_df = output_df[~output_df['id'].isin(non_complex_ids)]

# 提取所需的列
result_df = filtered_output_df[['id', 'video_path', 'question']]

# 将DataFrame保存为JSON文件
result_json = result_df.to_json(orient='records', lines=True)

# 将JSON写入文件
with open('complex.json', 'w') as json_file:
    json_file.write(result_json)

